# NewAPI 统一接口配置示例
# 
# NewAPI是一个统一的AI服务接口，可以集成多个AI服务商
# 通过负载均衡实现成本优化和高可用性

# 基础配置
newapi:
  # NewAPI服务地址 (例如: https://your-newapi-instance.com)
  base_url: "https://api.newapi.com"
  
  # API密钥
  api_key: "your-newapi-api-key"

  # 负载均衡配置
  load_balancer:
    # 策略: round-robin | weighted | least-cost
    strategy: "least-cost"
    
    # 服务商列表
    providers:
      # OpenAI
      - name: "openai"
        base_url: "https://api.openai.com"
        api_key: "${OPENAI_API_KEY}"
        models:
          - "gpt-4"
          - "gpt-4-turbo"
          - "gpt-3.5-turbo"
        priority: 10
        weight: 10
        enabled: true

      # Claude (Anthropic)
      - name: "claude"
        base_url: "https://api.anthropic.com"
        api_key: "${ANTHROPIC_API_KEY}"
        models:
          - "claude-3-opus"
          - "claude-3-sonnet"
          - "claude-3.5-sonnet"
        priority: 8
        weight: 8
        enabled: true

      # Google Gemini
      - name: "gemini"
        base_url: "https://generativelanguage.googleapis.com"
        api_key: "${GEMINI_API_KEY}"
        models:
          - "gemini-pro"
          - "gemini-pro-vision"
        priority: 7
        weight: 7
        enabled: true

      # 阿里云通义千问
      - name: "qwen"
        base_url: "https://dashscope.aliyuncs.com/api/v1"
        api_key: "${DASHSCOPE_API_KEY}"
        models:
          - "qwen-turbo"
          - "qwen-plus"
          - "qwen-max"
        priority: 9
        weight: 9
        enabled: true

      # 火山引擎 (豆包)
      - name: "doubao"
        base_url: "https://ark.cn-beijing.volces.com/api/v3"
        api_key: "${ARK_API_KEY}"
        models:
          - "doubao-pro-4k"
          - "doubao-pro-32k"
        priority: 10
        weight: 10
        enabled: true

      # Moonshot (月之暗面)
      - name: "moonshot"
        base_url: "https://api.moonshot.cn/v1"
        api_key: "${MOONSHOT_API_KEY}"
        models:
          - "moonshot-v1-8k"
          - "moonshot-v1-32k"
          - "moonshot-v1-128k"
        priority: 8
        weight: 8
        enabled: true

# 负载均衡策略说明:
# - round-robin: 轮询，每个请求依次分配到不同服务商
# - weighted: 加权轮询，根据权重分配请求
# - least-cost: 最低成本，优先选择价格最低的服务商
# - least-latency: 最低延迟，优先选择响应最快的服务商

# 使用示例:
# 
# 文本生成:
# curl -X POST http://localhost:5678/api/v1/newapi/text \
#   -H "Content-Type: application/json" \
#   -d '{
#     "model": "gpt-4",
#     "prompt": "写一个关于AI的短剧剧本",
#     "system_prompt": "你是一个专业编剧"
#   }'
#
# 图像生成:
# curl -X POST http://localhost:5678/api/v1/newapi/image \
#   -H "Content-Type: application/json" \
#   -d '{
#     "model": "dall-e-3",
#     "prompt": "一个 futuristic 城市天际线"
#   }'
#
# 获取统计:
# curl http://localhost:5678/api/v1/newapi/stats
